"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a,s=0;s<t.length;s++)a=t[s],a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}function _typeof(e){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var $window=$(window),$html=$("html"),$body=$("body");function initSentry(){var e=$body.data("sentry-dsn");e&&Sentry.init({dsn:e,environment:$body.data("sentry-env"),release:$body.data("version")})}initSentry();function csrfSafeMethod(e){return /^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}$.ajaxSetup({cache:!1,beforeSend:function(e,t){csrfSafeMethod(t.type)||this.crossDomain||e.setRequestHeader("X-CSRFToken",$("[name=csrfmiddlewaretoken]").val())},error:function(t){console.log("ERROR:",t,t.status,t.statusText)}});function initPlugin(e,t){return function(a){var s=Array.prototype.slice.call(arguments,1);return void 0===a||"object"===_typeof(a)?this.each(function(){$.data(this,"plugin_"+t)||$.data(this,"plugin_"+t,new e(this,a))}):void("string"==typeof a&&this.each(function(){var e=$.data(this,"plugin_"+t);if(e&&"function"==typeof e[a])e[a].apply(e,s);else throw new Error("Method "+a+" does not exist on jQuery."+t)}))}}function formatFileSize(e,t){var a=Math.log;if(0===e)return"0 Bytes";var s=Math.floor(a(e)/a(1000));return parseFloat((e/Math.pow(1000,s)).toFixed(t||2))+" "+["Bytes","kb","MB","GB","TB","PB","EB","ZB","YB"][s]}function updateHtmlContent(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:$body;e.updates&&e.updates.forEach(function(e){$(e.wrapper,t).html(e.content)})}function escapeText(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;"};return e.replace(/[&<>]/g,function(e){return t[e]||e})}function checkRedirect(e){e.redirect&&(e.toaster&&$body.toaster("saveToaster",e.toaster),window.location.href=e.redirect)}(function(e){"use strict";var t={selector:"a, [tabindex]"},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.el=s,this.$el=e(s),this.focus_method=!1,this.last_focus_method=!1,this.init()}return _createClass(a,[{key:"init",value:function(){var t=this;this.$el.on("focus",t.$settings.selector,function(){t.focus_method||(t.focus_method=t.last_focus_method),e(t.$settings.selector).attr("data-focus-method",t.focus_method),t.last_focus_method=t.focus_method,t.focus_method=!1}),$body.on("blur",t.$settings.selector,function(){e(t.$settings.selector).removeAttr("data-focus-method")}),$window.on("blur",function(){t.focus_method=!1}),$body.on("keydown",t.$settings.selector,function(){t.focus_method="key"}),$body.on("mousedown",t.$settings.selector,function(){"touch"===t.focus_method||(t.focus_method="mouse")}),$body.on("touchstart",t.$settings.selector,function(){t.focus_method="touch"})}}]),a}();e.fn.betterFocus=initPlugin(a,"betterFocus")})(jQuery),function(e){"use strict";var t=function(){function t(a){_classCallCheck(this,t),this.$el=e(a),this.$label=e("label[for="+this.$el.attr("id")+"]"),this.$value=e("[data-range-value]",this.$label),this.init()}return _createClass(t,[{key:"init",value:function(){var e=this;e.$el.on("input",function(){e.$value.html(e.$el.val())})}}]),t}();e.fn.formRange=initPlugin(t,"formRange")}(jQuery);function initHtmlTextarea(){var e=0<arguments.length&&arguments[0]!==void 0?arguments[0]:$body,t=$("[data-html-textarea]",e);t.each(function(e){var a=t.eq(e),s=a.tinymce();s&&s.remove();var l=$html.attr("lang");2===l.indexOf("-")&&(l=l.split("-"),l=l[0]+"_"+l[1].toUpperCase()),a.tinymce({branding:!1,content_css:"/static/css/tinymce.min.css",height:250,inline_styles:!1,language:l,menubar:!1,mode:"specific_textareas",plugins:"autolink contextmenu link lists spellchecker wordcount",toolbar:"styleselect | bold | numlist | bullist | link | undo redo cut copy paste pastetext | removeformat",style_formats:[{title:"Paragraph",block:"p"},{title:"Header 2",block:"h2"},{title:"Header 3",block:"h3"},{title:"Header 4",block:"h4"}],valid_elements:"h2,h3,h4,a,p,strong,li,ul,ol",valid_styles:"+a[id|rel|",setup:function(e){var t=$("#"+e.id);t.attr("disabled")&&(e.settings.readonly=!0)}}),s=a.tinymce(),s.on("change",function(){tinymce.triggerSave()}),s.on("focus",function(){var e=$("#"+s.id),t=$(".mce-tinymce",e.parents(".form-group"));t.addClass("focus")}),s.on("blur",function(){var e=$("#"+s.id),t=$(".mce-tinymce",e.parents(".form-group"));t.removeClass("focus")})}),$(document).on("focusin",function(e){$(e.target).closest(".mce-window").length&&e.stopImmediatePropagation()})}(function(e){"use strict";var t={addExtraData:function(e,t){return t},onUploadCompleted:function(){}},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.$el=e(s),this.$input=e("input[type=file]",this.$el),this.$button=e("button",this.$el),this.$progress_items=e("[data-progress-items]",this.$el),this.init()}return _createClass(a,[{key:"init",value:function(){var t=this;this.$input.on("change",function(){t.$files=this.files,t._initProgressBar(),t._updateButton()}),this.$button.on("click",function(){return 0<t.$files.length&&(t.$button.addClass("disabled"),t.$input.attr("disabled","disabled"),e.each(t.$files,function(a){var s=new FormData,l=t.$files[a];s=t.$settings.addExtraData(t.$el,s),s.append("file",l),e.ajax({contentType:!1,data:s,processData:!1,type:"POST",url:t.$el.data("ajax-upload"),success:function(e){t.$button.addClass("disabled"),t.$input.removeAttr("disabled"),t._clearInput(),t.$settings.onUploadCompleted(t.$el,e)},xhr:function(){return t._updateProgressBar(l)}})})),!1})}},{key:"reset",value:function(){var e=this;e._clearInput(),e.$progress_items.attr("hidden","hidden")}},{key:"_clearInput",value:function(){var e=this;bsCustomFileInput.destroy(),e.$input.val(""),bsCustomFileInput.init()}},{key:"_updateButton",value:function(){var e=this;0<e.$files.length&&!e.$input.hasClass("is-invalid")?e.$button.removeClass("disabled"):e.$button.addClass("disabled")}},{key:"_initProgressBar",value:function(){var t=this;if(!t.progress_item){var a=e("[data-progress-item]",t.$progress_items);t.progress_item=a.parent().html()}t.$progress_items.empty(),0<t.$files.length&&!this.$input.hasClass("is-invalid")?(t.$progress_items.removeAttr("hidden"),e.each(t.$files,function(a){var s=t.$files[a],l=e(t.progress_item.replace("%filename",s.name).replace("%filesize",formatFileSize(s.size,2)).replace("data-progress-item=\"\"","data-progress-item=\""+s.name+"\""));t.$progress_items.append(l)})):t.$progress_items.attr("hidden","hidden")}},{key:"_updateProgressBar",value:function(t){var a=this,s=e.ajaxSettings.xhr(),l=e("[data-progress-item=\""+t.name+"\"]",a.$el),o=e("[data-progress-bar]",l),r=e("[data-current-file-size]",l),n=e("[data-cancel-upload]",l),i=e("[data-upload-finished]",l);return s.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=e.total,a=e.loaded,s=100*a/t;o.css("width",s+"%"),o.attr("aria-valuenow",s),r.html(formatFileSize(a))}},!1),s.upload.addEventListener("loadstart",function(){n.removeClass("invisible")}),s.upload.addEventListener("load",function(){n.remove(),i.removeClass("d-none")}),s.upload.addEventListener("abort",function(){var t=e("[data-progress-item]",a.$progress_items).not(l);l.remove(),0===t.length&&(a.$input.removeAttr("disabled"),a.reset())}),n.on("click",function(){return s.abort(),!1}),s}}]),a}();e.fn.ajaxUpload=initPlugin(a,"ajaxUpload")})(jQuery),function(e){"use strict";var t={beforeSubmit:function(){},afterSubmit:function(){}},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.$el=e(s),this.prefix=this.$el.data("form"),this.$submit_button=e("button[type=\"submit\"]",this.$el),this.$validate_buttons=e("[data-validate]",this.$el),this.$html_textareas=e("[data-html-textarea]",this.$el),this.$formsets=e("[data-form-set]",this.$el),this.$form_errors=e("[data-form-errors]",this.$el),this.$form_errors_anchor=e("[data-form-errors-anchor]",this.$el),this.init()}return _createClass(a,[{key:"init",value:function(){var t=this;t.$el.on("blur input",":input:not(button)",function(){var a=e(this);t._validateInput(a)}),t.$html_textareas.each(function(a){var s=t.$html_textareas.eq(a),l=s.tinymce();l&&l.on("blur change",function(){var a=e(l.targetElm);t._validateInput(a)})}),t.$validate_buttons.on("click",function(){var e=t.$validate_buttons.index(this),a=t.$validate_buttons.eq(e);return t.response_type=a.data("response-type"),t._validateInputs(),t._checkFormValidity()?t.$el.data("form-is-invalid",!1):t.$el.data("form-is-invalid",!0),!1}),t.$submit_button.on("click",function(){var e=t.$submit_button.index(this),a=t.$submit_button.eq(e);t.submit_name=a.attr("name"),t.submit_value=a.attr("value")}),t.$el.on("submit",function(){return t.$settings.beforeSubmit(t.$el),t._validateInputs(),t._checkFormValidity()&&t._ajaxSubmit(),!1})}},{key:"reset",value:function(){var t=this;e(":input:not(button)",t.$el).each(function(){var a=e(this);t._removeErrorMessage(a),a.val("")})}},{key:"_addRequirements",value:function(t){var a=e(".label abbr",t.parents(".form-group"));a.hasClass("d-none")&&(a.removeClass("d-none"),!t.is(":checkbox")&&1===t.length&&t.attr("required","required"),t.parents("[data-field-hidden]").removeClass("d-none"),t.parents("[data-fieldset-hidden]").removeClass("d-none"))}},{key:"_removeRequirements",value:function(t){var a=this,s=e(".label abbr",t.parents(".form-group"));if(!s.hasClass("d-none")){s.addClass("d-none"),t.is(":checkbox")||1!==t.length||(t.removeAttr("required"),t.removeClass("is-invalid")),t.parents("[data-field-hidden]").addClass("d-none");var l=t.parents("[data-fieldset-hidden]"),o=e(".label abbr:not(.d-none)",l);0===o.length&&t.parents("[data-fieldset-hidden]").addClass("d-none"),a._removeErrorMessage(t)}}},{key:"_updateRequirements",value:function(t){var a=this;e.each(t,function(t,s){a.prefix&&(t=a.prefix+"-"+t);var l=e("[name=\""+t+"\"]");s?a._addRequirements(l):a._removeRequirements(l)})}},{key:"_inputIsVisible",value:function(e){return e.is(":visible")||e.data("html-textarea")&&e.prev(".mce-tinymce").is(":visible")}},{key:"_checkValidity",value:function(e){var t=this,a=!0,s=!1;return t._inputIsVisible(e)&&(e.attr("readonly")&&(s=!0,e.removeAttr("readonly")),!e[0].checkValidity()&&(a=!1),s&&e.attr("readonly","")),a}},{key:"_checkFormValidity",value:function(){var t=this,a=!0;return e(":input:not(button)",t.$el).each(function(){var s=e(this);if(a=t._checkValidity(s),!a)return!1}),a}},{key:"_validateData",value:function(e,t){var a=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],s=this,l=!0;t.is(":file")&&(l=s._validateInputFile(t)),s._checkValidity(t)&&l&&s._removeErrorMessage(t),s._insertErrorMessage(t,e.errors),s._updateRequirements(e.requirements),s._focusInput(a)}},{key:"_validateInputFile",value:function(t){var a=this,s=t[0].files,l=t.data("max-size"),o=0;if(0===s.length)return!0;if(e.each(s,function(e){o+=s[e].size}),o>l){var r=t.attr("name"),n={};return n[r]=[gettext("Please keep filesize under %max_upload_size. Current filesize is %size.").replace("%max_upload_size",formatFileSize(l)).replace("%size",formatFileSize(o))],a._insertErrorMessage(t,n),!1}return!0}},{key:"_validateInput",value:function(t){var a=this;e.ajax({contentType:!1,data:new FormData(a.$el[0]),processData:!1,type:"POST",url:a.$el.attr("action"),success:function(e){a._validateData(e,t,!1)}})}},{key:"_validateInputs",value:function(){var t=this,a=[];e(":input:not(button)",t.$el).each(function(){var s=e(this);t._inputIsVisible(s)&&a.push(s)}),e.ajax({contentType:!1,data:new FormData(t.$el[0]),processData:!1,type:"POST",url:t.$el.attr("action"),success:function(s){t._updateFormsetErrorMessages(s.errors),e.each(a,function(e,a){t._validateData(s,a,!0)})}})}},{key:"_updateFormErrorMessages",value:function(e){var t=this;e&&(e.__all__?(t.$form_errors.html(e.__all__),t.$form_errors.removeClass("d-none")):(t.$form_errors.empty(),t.$form_errors.addClass("d-none")))}},{key:"_updateFormsetErrorMessages",value:function(t){var a=this;a.$formsets.each(function(s){var l=a.$formsets.eq(s),o=e("[data-form-set-label]",l),r=e("[data-form-set-error]",l),n=t[r.attr("id").replace("_error","")]||"";r.html(n),n?(o.addClass("is-invalid"),r.focus()):o.removeClass("is-invalid")})}},{key:"_insertErrorMessage",value:function(t,a){var s=this;if(a){var l=t.attr("data-name")||t.attr("name"),o=a[l.replace(s.prefix+"-","")];if(o){var r=e("#id_"+l+"_error"),n=t.parents(".input-wrapper");n.addClass("is-invalid"),(t.is(":checkbox")||t.is(":radio"))&&(t=e("[name="+l+"]")),t.attr("data-html-textarea")&&(t=e(".mce-tinymce",t.parents(".form-group"))),0<n.length?e(":input",n).addClass("is-invalid"):t.addClass("is-invalid"),r.html(o)}}}},{key:"_removeErrorMessage",value:function(t){var a=t.data("name")||t.attr("name"),s=t.parents(".input-wrapper");s.removeClass("is-invalid"),(t.is(":checkbox")||t.is(":radio"))&&(t=e("[name="+a+"]")),t.data("html-textarea")&&(t=e(".mce-tinymce",t.parents(".form-group"))),0<s.length?e(":input",s).removeClass("is-invalid"):t.removeClass("is-invalid")}},{key:"_focusInput",value:function(t){var a=this;if(t)if(a.$form_errors.is(":visible"))a.$form_errors_anchor.focus();else{var s=e(".is-invalid",a.$el),l=s.first();l.is(":input")?l.focus():e(":input",l).first().focus()}}},{key:"_ajaxSubmit",value:function(){var t=this,a=new FormData(t.$el[0]);a.append("submit",1),t.submit_name&&t.submit_value&&a.append(t.submit_name,t.submit_value),t.response_type&&a.append("response_type",t.response_type),t.$submit_button.addClass("btn-loader");var s={contentType:!1,data:a,processData:!1,type:"POST",url:t.$el.attr("action"),success:function(e,a,s){t._updateFormErrorMessages(e.errors),t._focusInput(!0),t.$submit_button.removeClass("btn-loader"),t.$settings.afterSubmit(s,t.$el,e)}};t.response_type&&(s.xhrFields={responseType:t.response_type}),e.ajax(s)}}]),a}();e.fn.formValidation=initPlugin(a,"formValidation")}(jQuery),function(e){"use strict";var t={},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.$el=e(s),this.$steps=e("[data-step]",this.$el),this.$tabs=e("[data-tab]",this.$el),this.$select=e("[data-select]",this.$el),this.$summary=e("[data-summary]",this.$el),this.$previous=e("[data-previous]",this.$el),this.$next=e("[data-next]",this.$el),this.$submit=e("[data-submit]",this.$el),this.current_tab=0,this.init()}return _createClass(a,[{key:"init",value:function(){var e=this;e._initSummary(),e.$previous.on("click",function(){return e._changeTab(-1),!1}),e.$next.on("click",function(){return e._changeTab(1),!1}),e.$select.on("click",function(){var t=e.$select.index(this),a=e.$select.eq(t);return e.$el.data("form-is-invalid")||(e._updateSummary(),e.$tabs.removeClass("active"),e.current_tab=t,e._showStep(),e._updateButtons(),e._updateNav(),a.tab("show")),!1})}},{key:"_changeTab",value:function(e){var t=this;t.$el.data("form-is-invalid")||(t._updateSummary(),t.$tabs.removeClass("active"),t.current_tab+=e,t._showStep(),t._updateButtons(),t._updateNav())}},{key:"_showStep",value:function(){var e=this;e.$steps.addClass("d-none"),e.$steps.eq(e.current_tab).removeClass("d-none")}},{key:"_updateButtons",value:function(){var e=this,t=e.$tabs.eq(e.current_tab);t.addClass("active"),0===e.$previous.length||0===e.$next.length||(0===e.current_tab?(e.$previous.addClass("d-none"),e.$previous.removeClass("d-flex")):(e.$previous.addClass("d-flex"),e.$previous.removeClass("d-none")),e.current_tab===e.$tabs.length-1?(e.$next.addClass("d-none"),e.$next.removeClass("d-flex"),e.$submit.addClass("d-flex"),e.$submit.removeClass("d-none")):(e.$next.addClass("d-flex"),e.$next.removeClass("d-none"),e.$submit.addClass("d-none"),e.$submit.removeClass("d-flex")))}},{key:"_updateNav",value:function(){var e=this,t=e.$select.eq(e.current_tab);e.$select.removeClass("active"),e.$select.attr("aria-selected","false"),t.removeClass("disabled"),t.removeAttr("tabindex"),t.addClass("active"),t.attr("aria-selected","true"),t.removeAttr("aria-disabled")}},{key:"_initSummary",value:function(){var t=this;if(0!==t.$summary.length){var a=e("[data-summary-items]",t.$summary);t.summary_item_template=a.html(),e("[data-summary-item]",a).remove(),t.summary_step_template=t.$summary.html(),t.$summary.empty(),t.$summary.removeAttr("hidden")}}},{key:"_getSelectValue",value:function(t,a){var s=e("option:selected",t);return s.each(function(e){var t=s.eq(e);0<e&&(a+="<br>"),a+=t.text().trim()}),a}},{key:"_getFileValue",value:function(t,a){return e.each(t.prop("files"),function(e,t){0<e&&(a+="<br>"),a+=t.name}),a}},{key:"_getCheckboxRadioValue",value:function(t,a){var s=t.attr("id"),l=e("label[for=\""+s+"\"]").clone();return e("*",l).remove(),a+=l.text().trim(),a}},{key:"_addInputGroupText",value:function(t,a){var s=t.parents(".input-group"),l=e(".input-group-append",s).text(),o=e(".input-group-prepend",s).text();return l&&(a=a+" "+o),o&&(a=l+" "+a),a}},{key:"_updateSummary",value:function(){var t=this;if(0!==t.$summary.length){var a=t.$tabs.eq(t.current_tab),s=e("[data-summary-step=\""+t.current_tab+"\"]",t.$el),l=e(":input:visible:not(button):not([data-summary-hidden=\"1\"])",a),o="";if(0!==l.length){var r=e(".form-group",a);if(r.each(function(a){var s=r.eq(a),l=e(":input:visible:not(button)",s),n=e(".label, label",s).first().clone();e("*",n).remove();var i=n.text().trim(),d="";if(1===l.length){var u=l.val();l.is("select")?d=t._getSelectValue(l,d):l.is(":checkbox")?l.is(":checked")?d=gettext("Yes"):d=gettext("No"):l.is(":file")?d=t._getFileValue(l,d):(u&&(u=t._addInputGroupText(l,u)),d=escapeText(u))}else l.each(function(e){var a=l.eq(e);a.is(":checkbox")||a.is(":radio")?(0<e&&(d+="<br>"),d+=t._getCheckboxRadioValue(a,d)):(0<e&&(d+=" "),d+=escapeText(a.val()))});if(d.trim()){var c=t.summary_item_template.replace("%name",l.attr("name")).replace("%label",i).replace("%value",d);o+=c}}),0===s.length){var n=t.$steps.eq(t.current_tab),i=e(t.summary_step_template.replace("%step_index",t.current_tab).replace("%step",n.text()));e("[data-summary-items]",i).html(o),t.$summary.append(i)}else e("[data-summary-items]",s).html(o)}}}}]),a}();e.fn.formWizard=initPlugin(a,"formWizard")}(jQuery),function(e){"use strict";var t={},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.$el=e(s),this.$container=this.$el.parents(".file-tree"),this.$accept_extensions=this.$el.data("accept-extensions"),this.accept_folder=this.$el.data("accept-folder"),this.path=this.$el.data("file-tree"),this.root=this.$el.data("root"),this.$input=e("input",this.$el.parents(".form-group")),this.init()}return _createClass(a,[{key:"init",value:function(){var t=this;t._showTree(t.$el,t.root),t.$el.on("click","a",function(){var a=e(this),s=a.parent("li"),l=e("ul",s);return e("a",t.$el).removeClass("selected"),a.addClass("selected"),s.hasClass("directory")&&(l.remove(),s.hasClass("collapsed")?(s.removeClass("collapsed"),s.addClass("expanded"),t._showTree(s,a.data("item").match(/.*\//))):(s.removeClass("expanded"),s.addClass("collapsed"))),t._setInputValue(a),!1})}},{key:"reload",value:function(t){var a=this;a.selected_item=t.path;var s=a.selected_item.slice(a.root.length);s=s.match(/.*\//)[0];var l=s.split("/"),o=a._getItem(l,1);e("ul",o[0]).remove(),a._showTree(o[0],o[1],l,1)}},{key:"_setInputValue",value:function(e){var t=this,a=e.data("item");if(t.$input.val(""),t.$input.removeClass("is-invalid"),a)if(a.endsWith("/"))1===t.accept_folder&&t.$input.val(a);else{var s=a.split(".");if(1<s.length){var l="."+s[s.length-1];t.$accept_extensions&&-1<t.$accept_extensions.indexOf(l)&&t.$input.val(a)}}}},{key:"_getItem",value:function(t,a){var s=this,l=t.slice(0,a),o=s.root+l.join("/")+"/",r=e("[data-item=\""+o+"\"]",s.$container).parent("li");return r.length||(r=this.$el),0<a&&(r.removeClass("collapsed"),r.addClass("expanded")),[r,o]}},{key:"_scrollToSelectedItem",value:function(){var t=this,a=e("[data-item=\""+t.selected_item+"\"]");0<a.length&&(a.addClass("selected"),t._setInputValue(a),t.$el.scrollTop(t.$el.scrollTop()+a.position().top),t.$container.scrollTop(a.position().top-parseInt(t.$container.css("padding-top"))))}},{key:"_showTree",value:function(t,a,s,l){var o=this;e.post(o.path,{dir:escape(a)},function(e){if(t.append(e),s&&(l===s.length-1&&o._scrollToSelectedItem(),l<s.length-1)){l+=1;var a=o._getItem(s,l);o._showTree(a[0],a[1],s,l)}})}}]),a}();e.fn.formFileTree=initPlugin(a,"formFileTree")}(jQuery),function(e){"use strict";var t={selector:"[data-modal-link]",beforeModalOpen:function(){},onModalOpen:function(){},onModalClose:function(){}},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.el=s,this.$el=e(s),this.$modal_wrapper=e("#modal_wrapper"),this.init()}return _createClass(a,[{key:"init",value:function(){var t=this;t.$el.on("click",t.$settings.selector,function(){return e.ajax({url:this.href,success:function(a){t.$modal_wrapper.empty().html(a);var s=e("[data-modal]",t.$modal_wrapper);s.modal(),t.$settings.beforeModalOpen(s,a),s.on("shown.bs.modal",function(){t.$settings.onModalOpen(s,a)}),s.on("hidden.bs.modal",function(){t.$settings.onModalClose(s),t.$modal_wrapper.empty()})}}),!1})}}]),a}();e.fn.ajaxModal=initPlugin(a,"ajaxModal")}(jQuery),function(e){"use strict";var t={options:{},buttons:{},onInit:function(){},onStateLoaded:function(){},onDraw:function(){},customizeCSV:function(e){return e}},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.$el=e(s),this.$element=s,this.$fields=JSON.parse(s.getAttribute("data-fields")),this.url=s.getAttribute("data-table"),this.csfr_token=s.getAttribute("data-csrf-token"),this.$buttons=e("[data-button=\""+s.id+"\"]"),this.$reset=e("[data-reset=\""+s.id+"\"]"),this.$filter=e("[data-filter=\""+s.id+"\"]"),this.$filter_counter=e("[data-filter-counter=\""+s.id+"\"]"),this.$inputs=e("[data-input]",this.$filter),this.$selects=e("[data-select]",this.$filter),this.$processing=e("[data-processing]",s),this.$last_updated=e("[data-last-updated]",s),this.init()}return _createClass(a,[{key:"init",value:function(){var t=this;if(e.fn.dataTable){e.fn.dataTable.ext.errMode="throw",t._setClasses();var a=t._initDefaults();t.$api=t.$el.DataTable(a),t._hideColumns(),t._initButtons(),t._initFilters(),t._initEventListener(),t._checkFilters()}}},{key:"reload",value:function(t){var a=this,s=e(window).scrollTop();if(t){var l=t.url;l&&a.$api.ajax.url(l)}a.$api.ajax.reload(function(){e(window).scrollTop(s)},!1)}},{key:"_autoReload",value:function(){var e=this,t=e.$el.data("autoreload");t&&setInterval(function(){e.reload()},t)}},{key:"_restoreColumsClass",value:function(){var t=this,a=[];t.$api.rows().every(function(s){var l=t.$api.row(s).nodes(),o=e("td",l),r=[];o.each(function(e){var t=o.eq(e);r.push(t.attr("class"))}),a.push(r)}),t.$api.one("draw.dtr",function(){t.$api.rows().every(function(s){var l=t.$api.row(s).nodes(),o=e("td",l),r=a[s];r&&o.each(function(e){var t=o.eq(e);t.attr("class",r[e])})})})}},{key:"_hideColumns",value:function(){for(var e=this,t=0;t<e.$fields.length;t++)e.$fields[t].hide&&e.$api.column(t).visible(!1)}},{key:"_initEventListener",value:function(){var e=this;e.$api.on("init",function(t,a,s){e._lastUpdated(),e.$settings.onInit(e.$el,s)}),e.$api.on("stateLoaded",function(t,a,s){e.$settings.onStateLoaded(e.$el,s)}),e.$api.on("draw",function(){e.$settings.onDraw(e.$el)}),e.$api.on("preXhr.dtr",function(){e._restoreColumsClass()}),e.$api.on("processing.dt",function(t,a,s){e._processingIndicator(s)})}},{key:"_processingIndicator",value:function(e){var t=this;e?(t._lastUpdated(),t.$processing.removeClass("d-none")):t.$processing.addClass("d-none")}},{key:"_lastUpdated",value:function(){var e=this;if(0!==e.$last_updated.length){var t=e.$last_updated.data("text"),a=e.$last_updated.data("text-plural"),s=1;clearInterval(e.last_updated),e.$last_updated.text(t.replace("[seconds]",s)),e.last_updated=setInterval(function(){s+=1,e.$last_updated.text(a.replace("[seconds]",s))},1e3)}}},{key:"_defaultButtons",value:function(){var t=this,a=[];return t.$element.hasAttribute("data-export-csv")&&a.push({extend:"csv",exportOptions:{columns:"thead th:not(.no-export-csv)"},customize:function(e){return t.$settings.customizeCSV(e)}}),e.merge(a,t.$settings.buttons),a}},{key:"_initButtons",value:function(){var t=this;t.$buttons.on("click",function(){var t=this.getAttribute("data-button-action");e("."+t).click()})}},{key:"_initDefaults",value:function(){var t=this,a={autoWidth:!1,ajax:{beforeSend:function(e){e.setRequestHeader("X-CSRFToken",t.csfr_token)},type:"POST",url:t.url},buttons:{buttons:t._defaultButtons()},columnDefs:[{sortable:!1,targets:"no-sort"}],language:{sEmptyTable:gettext("No data available"),sInfo:gettext("Showing _START_ to _END_ of _TOTAL_ entries"),sInfoEmpty:gettext("Showing 0 to 0 of 0 entries"),sInfoThousands:".",sLengthMenu:gettext("Show _MENU_ entries"),sProcessing:gettext("Please wait ..."),sZeroRecords:gettext("No matching entries found"),paginate:{next:gettext("Next"),previous:gettext("Previous")},aria:{sortAscending:gettext(": activate to sort column ascending"),sortDescending:gettext(": activate to sort column descending")}},lengthMenu:[[10,50,100,-1],[10,50,100,gettext("All")]],ordering:!0,pagingType:"simple_numbers",processing:!0,serverSide:!0,stateSave:!0,stateLoaded:function(e,a){t._setStateFilters(a)},initComplete:function(){t._autoReload()}};return t.$settings.options.columns=t._loadDynamicFields(),e.extend(a,t.$settings.options),a}},{key:"_checkFilters",value:function(){var t=this,a=t.$inputs.filter(function(){return e(this).val()}),s=t.$selects.filter(function(){return e(this).val()});0<a.length||0<s.length?(t.$filter_counter.text(a.length+s.length),t.$reset.removeClass("disabled")):(t.$filter_counter.empty(),t.$reset.addClass("disabled"))}},{key:"_initFilters",value:function(){var t=this,a={};t.$inputs.on("input",function(){var e=t.$inputs.index(this),s=t.$inputs.eq(e),l=t.$api.column(s.data("column")),o=this.value;clearTimeout(a[e]),a[e]=setTimeout(function(){l.search(o).draw()},1200),t._checkFilters()}),t.$selects.on("change",function(){var e=t.$selects.index(this),a=t.$selects.eq(e),s=a.data("column"),l=t.$api.column(s);l.search(a.val()).draw(),t._checkFilters()}),t.$reset.on("click",function(){return t.$api.columns().search("").draw(),t.$inputs.val(""),t.$selects.each(function(a){var s=t.$selects.eq(a),l=e("[selected]",s).val();l?s.val(l):s.val("")}),t._checkFilters(),!1})}},{key:"_setClasses",value:function(){e.fn.dataTable.ext.classes.sInfo="dataTables_info",e.fn.dataTable.ext.classes.sLength="dataTables_length",e.fn.dataTable.ext.classes.sLengthSelect="custom-select",e.fn.dataTable.ext.classes.sPageButton="page-item page-link",e.fn.dataTable.ext.classes.sPageButtonActive="active",e.fn.dataTable.ext.classes.sSortAsc="sorting-asc",e.fn.dataTable.ext.classes.sSortColumn="sorting-",e.fn.dataTable.ext.classes.sSortDesc="sorting-desc",e.fn.dataTable.ext.classes.sTable="data-table"}},{key:"_loadDynamicFields",value:function(){for(var e=this,t=e.$settings.options.columns,a=[],s=0;s<t.length;s++)if("PLACEHOLDER_FIELDS"===t[s].data)for(var l=0;l<e.$fields.length;l++)a.push(e.$fields[l]);else a.push(t[s]);return a}},{key:"_setStateFilters",value:function(t){e.each(t.columns,function(a){var s=t.columns[a].search;if(s){var l=s.search;l&&e("[data-column="+a+"]").val(l)}})}}]),a}();e.fn.xDataTable=initPlugin(a,"xDataTable")}(jQuery),function(e){"use strict";var t={onDownloadStarted:function(){}},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.$el=e(s),this.init()}return _createClass(a,[{key:"init",value:function(){var t=this;t.$el.on("click",function(){return e.ajax({dataType:"json",type:"GET",url:this.href,success:function(e){if(t.$settings.onDownloadStarted(e),e.base64){var a=t._base64toBlob(e.base64,e.content_type);t._downloadBlob(a,e.file_name)}}}),!1})}},{key:"_downloadBlob",value:function(t,a){var s=window.URL||window.webkitURL,l=e("<a>");$body.append(l),l[0].href=s.createObjectURL(t),l[0].download=a,l[0].click(),window.URL.revokeObjectURL(s),l.remove()}},{key:"_base64toBlob",value:function(e,t){for(var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:512,s=atob(e),l=[],o=0;o<s.length;o+=a){for(var r=s.slice(o,o+a),n=Array(r.length),d=0;d<r.length;d++)n[d]=r.charCodeAt(d);var u=new Uint8Array(n);l.push(u)}return new Blob(l,{type:t})}}]),a}();e.fn.downloadBlob=initPlugin(a,"downloadBlob")}(jQuery),function(e){"use strict";var t={},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.$el=e(s),this.$body=e("[data-form-set-body]",this.$el),this.$template=e("[data-form-set-empty-item]",this.$el).html(),this.$add=e("[data-form-set-add]",this.$el),this.init()}return _createClass(a,[{key:"init",value:function(){var t=this,a=t.$el.data("form-set");t.$total_forms=e("#id_"+a+"-TOTAL_FORMS",this.$el),t.min_num_forms=parseInt(e("#id_"+a+"-MIN_NUM_FORMS").val()),t.max_num_forms=parseInt(e("#id_"+a+"-MAX_NUM_FORMS").val()),this.$add.on("click",function(){return t._addFormset(),!1}),t.$el.on("click","[data-form-set-delete]",function(){var a=e(this);return t._deleteFormset(a),!1})}},{key:"_addFormset",value:function(){var t=this,a=e("[data-form-set-item]:visible",t.$body).length,s=e("[data-form-set-item]",t.$body),l=s.length,o=e(t.$template.replace(/__prefix__/g,l));t.$body.append(o),o.find(":input:visible").first().focus(),o.attr("data-form-set-item",a),t.$total_forms.val(l+1),a+1===t.max_num_forms&&t.$add.addClass("disabled"),e("[data-form-set-delete]",o).removeClass("disabled");var r=e("[data-form-set-delete]",t.$el);a<t.min_num_forms?r.addClass("disabled"):r.removeClass("disabled")}},{key:"_deleteFormset",value:function(t){var a=this,s=e("[data-form-set-item]:visible",a.$body).length,l=e("[data-form-set-delete]",a.$el),o=t.parents("[data-form-set-item]");s-1===a.min_num_forms?l.addClass("disabled"):l.removeClass("disabled"),e(":input:visible",o).val(""),o.addClass("d-none"),s-1<a.max_num_forms&&a.$add.removeClass("disabled"),e("[name$=\"-DELETE\"]",o).click()}}]),a}();e.fn.formSet=initPlugin(a,"formSet")}(jQuery),function(e){"use strict";var t={selector:"[data-clipboard]",beforeCopyText:function(e,t){return t}},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.el=s,this.$el=e(s),this.$dummy=void 0,this.init()}return _createClass(a,[{key:"init",value:function(){var t=this;t.$el.on("click",t.$settings.selector,function(){var a=e(this),s=a.data("clipboard-text"),l=a.data("clipboard-target");return t.$target=e(l),t.action=a.data("clipboard"),s?(t.action="copy",t._fakeSelectText(s)):t._selectText(),t._copyText(),t._clearSelection(),!1})}},{key:"_fakeSelectText",value:function(t){var a=this;return t=a.$settings.beforeCopyText(a.$target,t),a.$dummy=e("<textarea>"),a.$dummy.val(t),a.$el.append(a.$dummy),a.$dummy.get(0).select(),a.$dummy.get(0).setSelectionRange(0,t.length),t}},{key:"_selectText",value:function(){var t,a=this;if(a.$target.is("select"))t=e("option:selected",a.$target).text().trim(),a._fakeSelectText(t);else if(a.$target.is("input")||a.$target.is("textarea")){var s=a.$target.attr("readonly"),l=a.$target.val().trim();s||a.$target.prop("readonly",!0),"copy"===a.action?a._fakeSelectText(l):(a.$target.get(0).select(),a.$target.get(0).setSelectionRange(0,l.length)),s||a.$target.removeAttr("readonly")}}},{key:"_clearSelection",value:function(){var e=this;document.activeElement.blur(),window.getSelection().removeAllRanges(),e.$el.focus(),e.$dummy&&e.$dummy.remove()}},{key:"_copyText",value:function(){var e=this;document.execCommand(e.action)}}]),a}();e.fn.clipBoard=initPlugin(a,"clipBoard")}(jQuery),function(e){"use strict";var t={selector:"[data-toaster]"},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.el=s,this.$el=e(s),this.$wrapper=e("#toaster_wrapper"),this.init()}return _createClass(a,[{key:"init",value:function(){var t=this;t.$el.on("click",t.$settings.selector,function(){var a=e(this),s=a.data("toaster");e.ajax({data:{success:!0,text:a.data("toaster-text")},type:"POST",url:s,success:function(e){t.updateToaster(e.toaster)}})}),t._restoreToaster()}},{key:"_restoreToaster",value:function(){var e=this,t=sessionStorage.getItem("toaster");t&&(e.updateToaster(t),sessionStorage.removeItem("toaster"))}},{key:"saveToaster",value:function(e){sessionStorage.setItem("toaster",e)}},{key:"updateToaster",value:function(t){var a=this;a.$wrapper.prepend(t);var s=e(".toast:not(.fade)",a.$wrapper);s.toast("show"),s.on("show.bs.toast",function(){e(this).toast("dispose")})}}]),a}();e.fn.toaster=initPlugin(a,"toaster")}(jQuery),function(e){"use strict";var t={selector:"[data-update-html-content]",update_interval:1e4},a=function(){function a(s,l){_classCallCheck(this,a),this.$settings=e.extend({},t,l),this.$el=e(s),this.$wrappers=e("[data-update-html-content]",s),this.init()}return _createClass(a,[{key:"init",value:function(){var e=this;e.$wrappers.each(function(){var t=this.getAttribute("data-update-html-content");if(t){var a=this,s=this.getAttribute("data-update-interval")||e.$settings.update_interval;e._update(a,t),e.interval=setInterval(function(){e._update(a,t)},s)}})}},{key:"_update",value:function(t,a){e.ajax({dataType:"json",url:a,success:function(e){updateHtmlContent(e,t)}})}}]),a}();e.fn.autoUpdateHtmlContent=initPlugin(a,"autoUpdateHtmlContent")}(jQuery);
//# sourceMappingURL=base.min.js.map
